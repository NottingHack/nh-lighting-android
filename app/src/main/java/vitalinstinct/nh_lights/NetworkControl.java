package vitalinstinct.nh_lights;


import org.eclipse.paho.client.mqttv3.MqttAsyncClient;
import org.java_websocket.drafts.Draft_6455;
import org.java_websocket.extensions.IExtension;
import org.java_websocket.protocols.IProtocol;
import org.java_websocket.protocols.Protocol;
import org.json.JSONException;
import org.json.JSONObject;

import java.net.URI;
import java.net.URISyntaxException;
import java.util.ArrayList;
import java.util.Collections;
import java.util.HashMap;
import java.util.Map;

/**
 * Created by Reece on 12/12/2018, vitalinstinct.nh_lights, nhLights
 */
public class NetworkControl {

    WebSocket cn;
    JSONProcessor json;
    ProcessHandler handler;

    JSONObject connectCommand;

    public NetworkControl(ProcessHandler handler, MainActivity activity) throws URISyntaxException {
        this.handler = handler;
        json = new JSONProcessor(handler);

        // This draft only allows you to use the specific Sec-WebSocket-Protocol without a fallback.
        Draft_6455 draft_ocppOnly = new Draft_6455(Collections.<IExtension>emptyList(), Collections.<IProtocol>singletonList(new Protocol("lighting")));

        // This draft allows the specific Sec-WebSocket-Protocol and also provides a fallback, if the other endpoint does not accept the specific Sec-WebSocket-Protocol
        ArrayList<IProtocol> protocols = new ArrayList<IProtocol>();
        protocols.add(new Protocol("lighting"));
        Draft_6455 draft_ocppAndFallBack = new Draft_6455(Collections.<IExtension>emptyList(), protocols);

        // delay required ?
        cn = new WebSocket(new URI("ws://queen:8181/lighting"), handler, draft_ocppOnly);
        cn.connect();
        try {
            Thread.sleep(1000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }


        MQTT client = new MQTT(activity);
        client.connect();

        connectCommand = json.jsonConstructInitialCommand("{token}");
        cn.send(connectCommand.toString());

    }

    public void sendWebMessage(JSONObject object)
    {
        //testing
        //[{"room":"CNC room","lights":[10,11,12,13,14,15],"eventType":"RoomDescription"},{"room":"Blue room","lights":[1,2,3,4,5,6,7,8,9],"eventType":"RoomDescription"},{"room":"Team storage","lights":[18,19],"eventType":"RoomDescription"},{"room":"Members storage","lights":[],"eventType":"RoomDescription"},{"room":"Class room","lights":[20,21,22,23,24,25,26,27,28,29,30,31],"eventType":"RoomDescription"},{"room":"Metal working","lights":[],"eventType":"RoomDescription"},{"room":"Disabled toilet","lights":[32],"eventType":"RoomDescription"},{"room":"CNC room corridor","lights":[16,17],"eventType":"RoomDescription"},{"room":"Corridor","lights":[],"eventType":"RoomDescription"},{"room":"Airlock","lights":[],"eventType":"RoomDescription"},{"room":"Kitchen","lights":[],"eventType":"RoomDescription"},{"room":"Toilets","lights":[],"eventType":"RoomDescription"},{"room":"Studio","lights":[],"eventType":"RoomDescription"},{"room":"Comfy area","lights":[],"eventType":"RoomDescription"},{"room":"Members storage","lights":[],"eventType":"RoomDescription"},{"room":"Craft room","lights":[],"eventType":"RoomDescription"},{"room":"Electronics","lights":[],"eventType":"RoomDescription"},{"room":"Dusty area","lights":[],"eventType":"RoomDescription"},{"room":"Wood working","lights":[],"eventType":"RoomDescription"},{"room":"Project storage","lights":[],"eventType":"RoomDescription"}]
        //[{"light":1,"state":"ON","room":"Blue room","eventType":"LightState"},{"light":2,"state":"ON","room":"Blue room","eventType":"LightState"},{"light":3,"state":"ON","room":"Blue room","eventType":"LightState"},{"light":4,"state":"ON","room":"Blue room","eventType":"LightState"},{"light":5,"state":"ON","room":"Blue room","eventType":"LightState"},{"light":6,"state":"ON","room":"Blue room","eventType":"LightState"},{"light":7,"state":"ON","room":"Blue room","eventType":"LightState"},{"light":8,"state":"ON","room":"Blue room","eventType":"LightState"},{"light":16,"state":"OFF","room":"CNC room corridor","eventType":"LightState"},{"light":15,"state":"ON","room":"CNC room","eventType":"LightState"},{"light":14,"state":"ON","room":"CNC room","eventType":"LightState"},{"light":13,"state":"ON","room":"CNC room","eventType":"LightState"},{"light":12,"state":"OFF","room":"CNC room","eventType":"LightState"},{"light":11,"state":"OFF","room":"CNC room","eventType":"LightState"},{"light":10,"state":"ON","room":"CNC room","eventType":"LightState"},{"light":9,"state":"ON","room":"Blue room","eventType":"LightState"},{"light":17,"state":"OFF","room":"CNC room corridor","eventType":"LightState"},{"light":18,"state":"ON","room":"Team storage","eventType":"LightState"},{"light":19,"state":"OFF","room":"Team storage","eventType":"LightState"}]
        //[{"patternId":1,"lights":[{"light":1,"state":"OFF","room":"Blue room"},{"light":2,"state":"OFF","room":"Blue room"},{"light":3,"state":"OFF","room":"Blue room"},{"light":4,"state":"OFF","room":"Blue room"},{"light":5,"state":"OFF","room":"Blue room"},{"light":6,"state":"OFF","room":"Blue room"},{"light":7,"state":"OFF","room":"Blue room"},{"light":8,"state":"OFF","room":"Blue room"},{"light":9,"state":"OFF","room":"Blue room"},{"light":10,"state":"OFF","room":"CNC room"},{"light":11,"state":"OFF","room":"CNC room"},{"light":12,"state":"OFF","room":"CNC room"},{"light":13,"state":"OFF","room":"CNC room"},{"light":14,"state":"OFF","room":"CNC room"},{"light":15,"state":"OFF","room":"CNC room"},{"light":16,"state":"OFF","room":"CNC room corridor"},{"light":17,"state":"OFF","room":"CNC room corridor"},{"light":18,"state":"OFF","room":"Team storage"},{"light":19,"state":"OFF","room":"Team storage"},{"light":20,"state":"OFF","room":"Class room"},{"light":21,"state":"OFF","room":"Class room"},{"light":22,"state":"OFF","room":"Class room"},{"light":23,"state":"OFF","room":"Class room"},{"light":24,"state":"OFF","room":"Class room"},{"light":25,"state":"OFF","room":"Class room"},{"light":26,"state":"OFF","room":"Class room"},{"light":27,"state":"OFF","room":"Class room"},{"light":28,"state":"OFF","room":"Class room"},{"light":29,"state":"OFF","room":"Class room"},{"light":30,"state":"OFF","room":"Class room"},{"light":31,"state":"OFF","room":"Class room"},{"light":32,"state":"OFF","room":"Disabled toilet"}],"eventType":"PatternDescrption","name":"All Off"},{"patternId":2,"lights":[{"light":1,"state":"ON","room":"Blue room"},{"light":2,"state":"ON","room":"Blue room"},{"light":3,"state":"ON","room":"Blue room"},{"light":4,"state":"ON","room":"Blue room"},{"light":5,"state":"ON","room":"Blue room"},{"light":6,"state":"ON","room":"Blue room"},{"light":7,"state":"ON","room":"Blue room"},{"light":8,"state":"ON","room":"Blue room"},{"light":9,"state":"ON","room":"Blue room"},{"light":10,"state":"ON","room":"CNC room"},{"light":11,"state":"ON","room":"CNC room"},{"light":12,"state":"ON","room":"CNC room"},{"light":13,"state":"ON","room":"CNC room"},{"light":14,"state":"ON","room":"CNC room"},{"light":15,"state":"ON","room":"CNC room"},{"light":16,"state":"ON","room":"CNC room corridor"},{"light":17,"state":"ON","room":"CNC room corridor"},{"light":18,"state":"ON","room":"Team storage"},{"light":19,"state":"ON","room":"Team storage"},{"light":20,"state":"ON","room":"Class room"},{"light":21,"state":"ON","room":"Class room"},{"light":22,"state":"ON","room":"Class room"},{"light":23,"state":"ON","room":"Class room"},{"light":24,"state":"ON","room":"Class room"},{"light":25,"state":"ON","room":"Class room"},{"light":26,"state":"ON","room":"Class room"},{"light":27,"state":"ON","room":"Class room"},{"light":28,"state":"ON","room":"Class room"},{"light":29,"state":"ON","room":"Class room"},{"light":30,"state":"ON","room":"Class room"},{"light":31,"state":"ON","room":"Class room"},{"light":32,"state":"ON","room":"Disabled toilet"}],"eventType":"PatternDescrption","name":"All On"},{"patternId":3,"lights":[{"light":4,"state":"ON","room":"Blue room"},{"light":5,"state":"ON","room":"Blue room"},{"light":6,"state":"ON","room":"Blue room"},{"light":7,"state":"ON","room":"Blue room"},{"light":8,"state":"ON","room":"Blue room"},{"light":9,"state":"ON","room":"Blue room"}],"eventType":"PatternDescrption","name":"Blue Room On"},{"patternId":4,"lights":[{"light":12,"state":"ON","room":"CNC room"},{"light":13,"state":"ON","room":"CNC room"},{"light":14,"state":"ON","room":"CNC room"},{"light":15,"state":"ON","room":"CNC room"}],"eventType":"PatternDescrption","name":"CNC Room On"},{"patternId":5,"lights":[{"light":18,"state":"ON","room":"Team storage"},{"light":19,"state":"ON","room":"Team storage"}],"eventType":"PatternDescrption","name":"Team Storage On"},{"patternId":6,"lights":[{"light":1,"state":"ON","room":"Blue room"},{"light":2,"state":"ON","room":"Blue room"},{"light":3,"state":"ON","room":"Blue room"},{"light":10,"state":"ON","room":"CNC room"},{"light":11,"state":"ON","room":"CNC room"},{"light":16,"state":"ON","room":"CNC room corridor"},{"light":17,"state":"ON","room":"CNC room corridor"}],"eventType":"PatternDescrption","name":"G4\/G5 Corridor On"},{"patternId":26,"lights":[{"light":4,"state":"OFF","room":"Blue room"},{"light":5,"state":"OFF","room":"Blue room"},{"light":6,"state":"OFF","room":"Blue room"},{"light":7,"state":"OFF","room":"Blue room"},{"light":8,"state":"OFF","room":"Blue room"},{"light":9,"state":"OFF","room":"Blue room"}],"eventType":"PatternDescrption","name":"Blue Room Off"},{"patternId":32,"lights":[{"light":12,"state":"OFF","room":"CNC room"},{"light":13,"state":"OFF","room":"CNC room"},{"light":14,"state":"OFF","room":"CNC room"},{"light":15,"state":"OFF","room":"CNC room"}],"eventType":"PatternDescrption","name":"CNC Room Off"},{"patternId":36,"lights":[{"light":3,"state":"TOGGLE","room":"Blue room"}],"eventType":"PatternDescrption","name":"Flash CNC (Start)"},{"patternId":39,"lights":[{"light":3,"state":"TOGGLE","room":"Blue room"}],"eventType":"PatternDescrption","name":"Flash CNC 1"},{"patternId":42,"lights":[{"light":2,"state":"TOGGLE","room":"Blue room"}],"eventType":"PatternDescrption","name":"Flash CNC 2"},{"patternId":45,"lights":[{"light":2,"state":"TOGGLE","room":"Blue room"}],"eventType":"PatternDescrption","name":"Flash CNC 3"},{"patternId":46,"lights":[{"light":1,"state":"TOGGLE","room":"Blue room"}],"eventType":"PatternDescrption","name":"Flash CNC 4"},{"patternId":47,"lights":[{"light":1,"state":"TOGGLE","room":"Blue room"}],"eventType":"PatternDescrption","name":"Flash CNC 5"},{"patternId":48,"lights":[{"light":11,"state":"TOGGLE","room":"CNC room"}],"eventType":"PatternDescrption","name":"Flash CNC 6"},{"patternId":49,"lights":[{"light":11,"state":"TOGGLE","room":"CNC room"}],"eventType":"PatternDescrption","name":"Flash CNC 7"},{"patternId":50,"lights":[{"light":10,"state":"TOGGLE","room":"CNC room"}],"eventType":"PatternDescrption","name":"Flash CNC 8"},{"patternId":51,"lights":[{"light":10,"state":"TOGGLE","room":"CNC room"}],"eventType":"PatternDescrption","name":"Flash CNC 9"},{"patternId":52,"lights":[{"light":17,"state":"TOGGLE","room":"CNC room corridor"}],"eventType":"PatternDescrption","name":"Flash CNC 10"},{"patternId":53,"lights":[{"light":17,"state":"TOGGLE","room":"CNC room corridor"}],"eventType":"PatternDescrption","name":"Flash CNC 11"},{"patternId":54,"lights":[{"light":16,"state":"TOGGLE","room":"CNC room corridor"}],"eventType":"PatternDescrption","name":"Flash CNC 12"},{"patternId":55,"lights":[{"light":16,"state":"TOGGLE","room":"CNC room corridor"}],"eventType":"PatternDescrption","name":"Flash CNC 13"},{"patternId":56,"lights":[{"light":16,"state":"TOGGLE","room":"CNC room corridor"}],"eventType":"PatternDescrption","name":"Flash Blue (Start)"},{"patternId":57,"lights":[{"light":16,"state":"TOGGLE","room":"CNC room corridor"}],"eventType":"PatternDescrption","name":"Flash Blue 1"},{"patternId":58,"lights":[{"light":17,"state":"TOGGLE","room":"CNC room corridor"}],"eventType":"PatternDescrption","name":"Flash Blue 2"},{"patternId":59,"lights":[{"light":17,"state":"TOGGLE","room":"CNC room corridor"}],"eventType":"PatternDescrption","name":"Flash Blue 3"},{"patternId":60,"lights":[{"light":10,"state":"TOGGLE","room":"CNC room"}],"eventType":"PatternDescrption","name":"Flash Blue 4"},{"patternId":61,"lights":[{"light":10,"state":"TOGGLE","room":"CNC room"}],"eventType":"PatternDescrption","name":"Flash Blue 5"},{"patternId":62,"lights":[{"light":11,"state":"TOGGLE","room":"CNC room"}],"eventType":"PatternDescrption","name":"Flash Blue 6"},{"patternId":63,"lights":[{"light":11,"state":"TOGGLE","room":"CNC room"}],"eventType":"PatternDescrption","name":"Flash Blue 7"},{"patternId":64,"lights":[{"light":1,"state":"TOGGLE","room":"Blue room"}],"eventType":"PatternDescrption","name":"Flash Blue 8"},{"patternId":65,"lights":[{"light":1,"state":"TOGGLE","room":"Blue room"}],"eventType":"PatternDescrption","name":"Flash Blue 9"},{"patternId":66,"lights":[{"light":2,"state":"TOGGLE","room":"Blue room"}],"eventType":"PatternDescrption","name":"Flash Blue 10"},{"patternId":67,"lights":[{"light":2,"state":"TOGGLE","room":"Blue room"}],"eventType":"PatternDescrption","name":"Flash Blue 11"},{"patternId":68,"lights":[{"light":3,"state":"TOGGLE","room":"Blue room"}],"eventType":"PatternDescrption","name":"Flash Blue 12"},{"patternId":69,"lights":[{"light":3,"state":"TOGGLE","room":"Blue room"}],"eventType":"PatternDescrption","name":"Flash Blue 13"},{"patternId":90,"lights":[{"light":1,"state":"OFF","room":"Blue room"},{"light":2,"state":"OFF","room":"Blue room"},{"light":3,"state":"OFF","room":"Blue room"},{"light":4,"state":"OFF","room":"Blue room"},{"light":5,"state":"ON","room":"Blue room"},{"light":6,"state":"OFF","room":"Blue room"},{"light":7,"state":"OFF","room":"Blue room"},{"light":8,"state":"OFF","room":"Blue room"},{"light":9,"state":"OFF","room":"Blue room"}],"eventType":"PatternDescrption","name":"Roll 1"},{"patternId":93,"lights":[{"light":1,"state":"OFF","room":"Blue room"},{"light":2,"state":"OFF","room":"Blue room"},{"light":3,"state":"ON","room":"Blue room"},{"light":4,"state":"OFF","room":"Blue room"},{"light":5,"state":"OFF","room":"Blue room"},{"light":6,"state":"OFF","room":"Blue room"},{"light":7,"state":"ON","room":"Blue room"},{"light":8,"state":"OFF","room":"Blue room"},{"light":9,"state":"OFF","room":"Blue room"}],"eventType":"PatternDescrption","name":"Roll 2"},{"patternId":96,"lights":[{"light":1,"state":"ON","room":"Blue room"},{"light":2,"state":"OFF","room":"Blue room"},{"light":3,"state":"OFF","room":"Blue room"},{"light":4,"state":"OFF","room":"Blue room"},{"light":5,"state":"ON","room":"Blue room"},{"light":6,"state":"OFF","room":"Blue room"},{"light":7,"state":"OFF","room":"Blue room"},{"light":8,"state":"OFF","room":"Blue room"},{"light":9,"state":"ON","room":"Blue room"}],"eventType":"PatternDescrption","name":"Roll 3"},{"patternId":99,"lights":[{"light":1,"state":"ON","room":"Blue room"},{"light":2,"state":"OFF","room":"Blue room"},{"light":3,"state":"ON","room":"Blue room"},{"light":4,"state":"OFF","room":"Blue room"},{"light":5,"state":"OFF","room":"Blue room"},{"light":6,"state":"OFF","room":"Blue room"},{"light":7,"state":"ON","room":"Blue room"},{"light":8,"state":"OFF","room":"Blue room"},{"light":9,"state":"ON","room":"Blue room"}],"eventType":"PatternDescrption","name":"Roll 4"},{"patternId":102,"lights":[{"light":1,"state":"ON","room":"Blue room"},{"light":2,"state":"OFF","room":"Blue room"},{"light":3,"state":"ON","room":"Blue room"},{"light":4,"state":"OFF","room":"Blue room"},{"light":5,"state":"ON","room":"Blue room"},{"light":6,"state":"OFF","room":"Blue room"},{"light":7,"state":"ON","room":"Blue room"},{"light":8,"state":"OFF","room":"Blue room"},{"light":9,"state":"ON","room":"Blue room"}],"eventType":"PatternDescrption","name":"Roll 5"},{"patternId":105,"lights":[{"light":1,"state":"ON","room":"Blue room"},{"light":2,"state":"OFF","room":"Blue room"},{"light":3,"state":"ON","room":"Blue room"},{"light":4,"state":"ON","room":"Blue room"},{"light":5,"state":"OFF","room":"Blue room"},{"light":6,"state":"ON","room":"Blue room"},{"light":7,"state":"ON","room":"Blue room"},{"light":8,"state":"OFF","room":"Blue room"},{"light":9,"state":"ON","room":"Blue room"}],"eventType":"PatternDescrption","name":"Roll 6"},{"patternId":108,"lights":[{"light":1,"state":"OFF","room":"Blue room"},{"light":2,"state":"OFF","room":"Blue room"},{"light":3,"state":"OFF","room":"Blue room"},{"light":4,"state":"OFF","room":"Blue room"},{"light":5,"state":"OFF","room":"Blue room"},{"light":6,"state":"OFF","room":"Blue room"},{"light":7,"state":"OFF","room":"Blue room"},{"light":8,"state":"OFF","room":"Blue room"},{"light":9,"state":"OFF","room":"Blue room"}],"eventType":"PatternDescrption","name":"Roll Clear"}]
       // cn.onMessage("[{'room':'CNC room','lights':[10,11,12,13,14,15],'eventType':'RoomDescription'},{'room':'Blue room','lights':[1,2,3,4,5,6,7,8,9],'eventType':'RoomDescription'},{'room':'Team storage','lights':[18,19],'eventType':'RoomDescription'},{'room':'Members storage','lights':[],'eventType':'RoomDescription'},{'room':'Class room','lights':[20,21,22,23,24,25,26,27,28,29,30,31],'eventType':'RoomDescription'},{'room':'Metal working','lights':[],'eventType':'RoomDescription'},{'room':'Disabled toilet','lights':[32],'eventType':'RoomDescription'},{'room':'CNC room corridor','lights':[16,17],'eventType':'RoomDescription'},{'room':'Corridor','lights':[],'eventType':'RoomDescription'},{'room':'Airlock','lights':[],'eventType':'RoomDescription'},{'room':'Kitchen','lights':[],'eventType':'RoomDescription'},{'room':'Toilets','lights':[],'eventType':'RoomDescription'},{'room':'Studio','lights':[],'eventType':'RoomDescription'},{'room':'Comfy area','lights':[],'eventType':'RoomDescription'},{'room':'Members storage','lights':[],'eventType':'RoomDescription'},{'room':'Craft room','lights':[],'eventType':'RoomDescription'},{'room':'Electronics','lights':[],'eventType':'RoomDescription'},{'room':'Dusty area','lights':[],'eventType':'RoomDescription'},{'room':'Wood working','lights':[],'eventType':'RoomDescription'},{'room':'Project storage','lights':[],'eventType':'RoomDescription'}]");
       // cn.onMessage("[{'light':1,'state':'ON','room':'Blue room','eventType':'LightState'},{'light':2,'state':'ON','room':'Blue room','eventType':'LightState'},{'light':3,'state':'ON','room':'Blue room','eventType':'LightState'},{'light':4,'state':'ON','room':'Blue room','eventType':'LightState'},{'light':5,'state':'ON','room':'Blue room','eventType':'LightState'},{'light':6,'state':'ON','room':'Blue room','eventType':'LightState'},{'light':7,'state':'ON','room':'Blue room','eventType':'LightState'},{'light':8,'state':'ON','room':'Blue room','eventType':'LightState'},{'light':16,'state':'OFF','room':'CNC room corridor','eventType':'LightState'},{'light':15,'state':'ON','room':'CNC room','eventType':'LightState'},{'light':14,'state':'ON','room':'CNC room','eventType':'LightState'},{'light':13,'state':'ON','room':'CNC room','eventType':'LightState'},{'light':12,'state':'OFF','room':'CNC room','eventType':'LightState'},{'light':11,'state':'OFF','room':'CNC room','eventType':'LightState'},{'light':10,'state':'ON','room':'CNC room','eventType':'LightState'},{'light':9,'state':'ON','room':'Blue room','eventType':'LightState'},{'light':17,'state':'OFF','room':'CNC room corridor','eventType':'LightState'},{'light':18,'state':'ON','room':'Team storage','eventType':'LightState'},{'light':19,'state':'OFF','room':'Team storage','eventType':'LightState'}]");
        //cn.onMessage("[{'patternId':1,'lights':[{'light':1,'state':'OFF','room':'Blue room'},{'light':2,'state':'OFF','room':'Blue room'},{'light':3,'state':'OFF','room':'Blue room'},{'light':4,'state':'OFF','room':'Blue room'},{'light':5,'state':'OFF','room':'Blue room'},{'light':6,'state':'OFF','room':'Blue room'},{'light':7,'state':'OFF','room':'Blue room'},{'light':8,'state':'OFF','room':'Blue room'},{'light':9,'state':'OFF','room':'Blue room'},{'light':10,'state':'OFF','room':'CNC room'},{'light':11,'state':'OFF','room':'CNC room'},{'light':12,'state':'OFF','room':'CNC room'},{'light':13,'state':'OFF','room':'CNC room'},{'light':14,'state':'OFF','room':'CNC room'},{'light':15,'state':'OFF','room':'CNC room'},{'light':16,'state':'OFF','room':'CNC room corridor'},{'light':17,'state':'OFF','room':'CNC room corridor'},{'light':18,'state':'OFF','room':'Team storage'},{'light':19,'state':'OFF','room':'Team storage'},{'light':20,'state':'OFF','room':'Class room'},{'light':21,'state':'OFF','room':'Class room'},{'light':22,'state':'OFF','room':'Class room'},{'light':23,'state':'OFF','room':'Class room'},{'light':24,'state':'OFF','room':'Class room'},{'light':25,'state':'OFF','room':'Class room'},{'light':26,'state':'OFF','room':'Class room'},{'light':27,'state':'OFF','room':'Class room'},{'light':28,'state':'OFF','room':'Class room'},{'light':29,'state':'OFF','room':'Class room'},{'light':30,'state':'OFF','room':'Class room'},{'light':31,'state':'OFF','room':'Class room'},{'light':32,'state':'OFF','room':'Disabled toilet'}],'eventType':'PatternDescrption','name':'All Off'},{'patternId':2,'lights':[{'light':1,'state':'ON','room':'Blue room'},{'light':2,'state':'ON','room':'Blue room'},{'light':3,'state':'ON','room':'Blue room'},{'light':4,'state':'ON','room':'Blue room'},{'light':5,'state':'ON','room':'Blue room'},{'light':6,'state':'ON','room':'Blue room'},{'light':7,'state':'ON','room':'Blue room'},{'light':8,'state':'ON','room':'Blue room'},{'light':9,'state':'ON','room':'Blue room'},{'light':10,'state':'ON','room':'CNC room'},{'light':11,'state':'ON','room':'CNC room'},{'light':12,'state':'ON','room':'CNC room'},{'light':13,'state':'ON','room':'CNC room'},{'light':14,'state':'ON','room':'CNC room'},{'light':15,'state':'ON','room':'CNC room'},{'light':16,'state':'ON','room':'CNC room corridor'},{'light':17,'state':'ON','room':'CNC room corridor'},{'light':18,'state':'ON','room':'Team storage'},{'light':19,'state':'ON','room':'Team storage'},{'light':20,'state':'ON','room':'Class room'},{'light':21,'state':'ON','room':'Class room'},{'light':22,'state':'ON','room':'Class room'},{'light':23,'state':'ON','room':'Class room'},{'light':24,'state':'ON','room':'Class room'},{'light':25,'state':'ON','room':'Class room'},{'light':26,'state':'ON','room':'Class room'},{'light':27,'state':'ON','room':'Class room'},{'light':28,'state':'ON','room':'Class room'},{'light':29,'state':'ON','room':'Class room'},{'light':30,'state':'ON','room':'Class room'},{'light':31,'state':'ON','room':'Class room'},{'light':32,'state':'ON','room':'Disabled toilet'}],'eventType':'PatternDescrption','name':'All On'},{'patternId':3,'lights':[{'light':4,'state':'ON','room':'Blue room'},{'light':5,'state':'ON','room':'Blue room'},{'light':6,'state':'ON','room':'Blue room'},{'light':7,'state':'ON','room':'Blue room'},{'light':8,'state':'ON','room':'Blue room'},{'light':9,'state':'ON','room':'Blue room'}],'eventType':'PatternDescrption','name':'Blue Room On'},{'patternId':4,'lights':[{'light':12,'state':'ON','room':'CNC room'},{'light':13,'state':'ON','room':'CNC room'},{'light':14,'state':'ON','room':'CNC room'},{'light':15,'state':'ON','room':'CNC room'}],'eventType':'PatternDescrption','name':'CNC Room On'},{'patternId':5,'lights':[{'light':18,'state':'ON','room':'Team storage'},{'light':19,'state':'ON','room':'Team storage'}],'eventType':'PatternDescrption','name':'Team Storage On'},{'patternId':6,'lights':[{'light':1,'state':'ON','room':'Blue room'},{'light':2,'state':'ON','room':'Blue room'},{'light':3,'state':'ON','room':'Blue room'},{'light':10,'state':'ON','room':'CNC room'},{'light':11,'state':'ON','room':'CNC room'},{'light':16,'state':'ON','room':'CNC room corridor'},{'light':17,'state':'ON','room':'CNC room corridor'}],'eventType':'PatternDescrption','name':'G4\\/G5 Corridor On'},{'patternId':26,'lights':[{'light':4,'state':'OFF','room':'Blue room'},{'light':5,'state':'OFF','room':'Blue room'},{'light':6,'state':'OFF','room':'Blue room'},{'light':7,'state':'OFF','room':'Blue room'},{'light':8,'state':'OFF','room':'Blue room'},{'light':9,'state':'OFF','room':'Blue room'}],'eventType':'PatternDescrption','name':'Blue Room Off'},{'patternId':32,'lights':[{'light':12,'state':'OFF','room':'CNC room'},{'light':13,'state':'OFF','room':'CNC room'},{'light':14,'state':'OFF','room':'CNC room'},{'light':15,'state':'OFF','room':'CNC room'}],'eventType':'PatternDescrption','name':'CNC Room Off'},{'patternId':36,'lights':[{'light':3,'state':'TOGGLE','room':'Blue room'}],'eventType':'PatternDescrption','name':'Flash CNC (Start)'},{'patternId':39,'lights':[{'light':3,'state':'TOGGLE','room':'Blue room'}],'eventType':'PatternDescrption','name':'Flash CNC 1'},{'patternId':42,'lights':[{'light':2,'state':'TOGGLE','room':'Blue room'}],'eventType':'PatternDescrption','name':'Flash CNC 2'},{'patternId':45,'lights':[{'light':2,'state':'TOGGLE','room':'Blue room'}],'eventType':'PatternDescrption','name':'Flash CNC 3'},{'patternId':46,'lights':[{'light':1,'state':'TOGGLE','room':'Blue room'}],'eventType':'PatternDescrption','name':'Flash CNC 4'},{'patternId':47,'lights':[{'light':1,'state':'TOGGLE','room':'Blue room'}],'eventType':'PatternDescrption','name':'Flash CNC 5'},{'patternId':48,'lights':[{'light':11,'state':'TOGGLE','room':'CNC room'}],'eventType':'PatternDescrption','name':'Flash CNC 6'},{'patternId':49,'lights':[{'light':11,'state':'TOGGLE','room':'CNC room'}],'eventType':'PatternDescrption','name':'Flash CNC 7'},{'patternId':50,'lights':[{'light':10,'state':'TOGGLE','room':'CNC room'}],'eventType':'PatternDescrption','name':'Flash CNC 8'},{'patternId':51,'lights':[{'light':10,'state':'TOGGLE','room':'CNC room'}],'eventType':'PatternDescrption','name':'Flash CNC 9'},{'patternId':52,'lights':[{'light':17,'state':'TOGGLE','room':'CNC room corridor'}],'eventType':'PatternDescrption','name':'Flash CNC 10'},{'patternId':53,'lights':[{'light':17,'state':'TOGGLE','room':'CNC room corridor'}],'eventType':'PatternDescrption','name':'Flash CNC 11'},{'patternId':54,'lights':[{'light':16,'state':'TOGGLE','room':'CNC room corridor'}],'eventType':'PatternDescrption','name':'Flash CNC 12'},{'patternId':55,'lights':[{'light':16,'state':'TOGGLE','room':'CNC room corridor'}],'eventType':'PatternDescrption','name':'Flash CNC 13'},{'patternId':56,'lights':[{'light':16,'state':'TOGGLE','room':'CNC room corridor'}],'eventType':'PatternDescrption','name':'Flash Blue (Start)'},{'patternId':57,'lights':[{'light':16,'state':'TOGGLE','room':'CNC room corridor'}],'eventType':'PatternDescrption','name':'Flash Blue 1'},{'patternId':58,'lights':[{'light':17,'state':'TOGGLE','room':'CNC room corridor'}],'eventType':'PatternDescrption','name':'Flash Blue 2'},{'patternId':59,'lights':[{'light':17,'state':'TOGGLE','room':'CNC room corridor'}],'eventType':'PatternDescrption','name':'Flash Blue 3'},{'patternId':60,'lights':[{'light':10,'state':'TOGGLE','room':'CNC room'}],'eventType':'PatternDescrption','name':'Flash Blue 4'},{'patternId':61,'lights':[{'light':10,'state':'TOGGLE','room':'CNC room'}],'eventType':'PatternDescrption','name':'Flash Blue 5'},{'patternId':62,'lights':[{'light':11,'state':'TOGGLE','room':'CNC room'}],'eventType':'PatternDescrption','name':'Flash Blue 6'},{'patternId':63,'lights':[{'light':11,'state':'TOGGLE','room':'CNC room'}],'eventType':'PatternDescrption','name':'Flash Blue 7'},{'patternId':64,'lights':[{'light':1,'state':'TOGGLE','room':'Blue room'}],'eventType':'PatternDescrption','name':'Flash Blue 8'},{'patternId':65,'lights':[{'light':1,'state':'TOGGLE','room':'Blue room'}],'eventType':'PatternDescrption','name':'Flash Blue 9'},{'patternId':66,'lights':[{'light':2,'state':'TOGGLE','room':'Blue room'}],'eventType':'PatternDescrption','name':'Flash Blue 10'},{'patternId':67,'lights':[{'light':2,'state':'TOGGLE','room':'Blue room'}],'eventType':'PatternDescrption','name':'Flash Blue 11'},{'patternId':68,'lights':[{'light':3,'state':'TOGGLE','room':'Blue room'}],'eventType':'PatternDescrption','name':'Flash Blue 12'},{'patternId':69,'lights':[{'light':3,'state':'TOGGLE','room':'Blue room'}],'eventType':'PatternDescrption','name':'Flash Blue 13'},{'patternId':90,'lights':[{'light':1,'state':'OFF','room':'Blue room'},{'light':2,'state':'OFF','room':'Blue room'},{'light':3,'state':'OFF','room':'Blue room'},{'light':4,'state':'OFF','room':'Blue room'},{'light':5,'state':'ON','room':'Blue room'},{'light':6,'state':'OFF','room':'Blue room'},{'light':7,'state':'OFF','room':'Blue room'},{'light':8,'state':'OFF','room':'Blue room'},{'light':9,'state':'OFF','room':'Blue room'}],'eventType':'PatternDescrption','name':'Roll 1'},{'patternId':93,'lights':[{'light':1,'state':'OFF','room':'Blue room'},{'light':2,'state':'OFF','room':'Blue room'},{'light':3,'state':'ON','room':'Blue room'},{'light':4,'state':'OFF','room':'Blue room'},{'light':5,'state':'OFF','room':'Blue room'},{'light':6,'state':'OFF','room':'Blue room'},{'light':7,'state':'ON','room':'Blue room'},{'light':8,'state':'OFF','room':'Blue room'},{'light':9,'state':'OFF','room':'Blue room'}],'eventType':'PatternDescrption','name':'Roll 2'},{'patternId':96,'lights':[{'light':1,'state':'ON','room':'Blue room'},{'light':2,'state':'OFF','room':'Blue room'},{'light':3,'state':'OFF','room':'Blue room'},{'light':4,'state':'OFF','room':'Blue room'},{'light':5,'state':'ON','room':'Blue room'},{'light':6,'state':'OFF','room':'Blue room'},{'light':7,'state':'OFF','room':'Blue room'},{'light':8,'state':'OFF','room':'Blue room'},{'light':9,'state':'ON','room':'Blue room'}],'eventType':'PatternDescrption','name':'Roll 3'},{'patternId':99,'lights':[{'light':1,'state':'ON','room':'Blue room'},{'light':2,'state':'OFF','room':'Blue room'},{'light':3,'state':'ON','room':'Blue room'},{'light':4,'state':'OFF','room':'Blue room'},{'light':5,'state':'OFF','room':'Blue room'},{'light':6,'state':'OFF','room':'Blue room'},{'light':7,'state':'ON','room':'Blue room'},{'light':8,'state':'OFF','room':'Blue room'},{'light':9,'state':'ON','room':'Blue room'}],'eventType':'PatternDescrption','name':'Roll 4'},{'patternId':102,'lights':[{'light':1,'state':'ON','room':'Blue room'},{'light':2,'state':'OFF','room':'Blue room'},{'light':3,'state':'ON','room':'Blue room'},{'light':4,'state':'OFF','room':'Blue room'},{'light':5,'state':'ON','room':'Blue room'},{'light':6,'state':'OFF','room':'Blue room'},{'light':7,'state':'ON','room':'Blue room'},{'light':8,'state':'OFF','room':'Blue room'},{'light':9,'state':'ON','room':'Blue room'}],'eventType':'PatternDescrption','name':'Roll 5'},{'patternId':105,'lights':[{'light':1,'state':'ON','room':'Blue room'},{'light':2,'state':'OFF','room':'Blue room'},{'light':3,'state':'ON','room':'Blue room'},{'light':4,'state':'ON','room':'Blue room'},{'light':5,'state':'OFF','room':'Blue room'},{'light':6,'state':'ON','room':'Blue room'},{'light':7,'state':'ON','room':'Blue room'},{'light':8,'state':'OFF','room':'Blue room'},{'light':9,'state':'ON','room':'Blue room'}],'eventType':'PatternDescrption','name':'Roll 6'},{'patternId':108,'lights':[{'light':1,'state':'OFF','room':'Blue room'},{'light':2,'state':'OFF','room':'Blue room'},{'light':3,'state':'OFF','room':'Blue room'},{'light':4,'state':'OFF','room':'Blue room'},{'light':5,'state':'OFF','room':'Blue room'},{'light':6,'state':'OFF','room':'Blue room'},{'light':7,'state':'OFF','room':'Blue room'},{'light':8,'state':'OFF','room':'Blue room'},{'light':9,'state':'OFF','room':'Blue room'}],'eventType':'PatternDescrption','name':'Roll Clear'}]");

        cn.send(object.toString());
        System.out.println( "sent: " + object.toString() );
    }

    public void getLights(String room, ArrayList<Integer> room_lights)
    {
        // internal confirm command?
        JSONObject obj = new JSONObject();
        try {
            obj.put("eventType", "lightsLoaded");
            json.jsonDecodeResponseObject(obj);
        } catch (JSONException e) {
            e.printStackTrace();
        }

    }

}
